
{% load static %}

<!DOCTYPE html>

<style>
  /* body {
    background-image: url(https://img.freepik.com/free-vector/white-background-with-triangle-patterns_1017-18410.jpg?w=2000);
  }  */

  .card-img-top {
    width: 100%;
    height: 15vw;
    object-fit: cover;
  }
  .card{
    border-radius: 20px;
    background: #fff;
    box-shadow: 0 6px 10px rgba(0,0,0,.08), 0 0 6px rgba(0,0,0,.05);
    transition: .3s ;
    overflow: hidden;
    cursor: pointer;
   
  }

  .card:hover{
    transform: scale(1.09);
    box-shadow: 0 10px 20px rgba(0,0,0,.12), 0 4px 8px rgba(0,0,0,.06);
  }

  .navbar{
    background-color: rgb(0, 0, 0);
  }

  .blmada{
    font-style: italic;
    text-align: center;
  }

  .cardlink{
    size: 0;
  }
</style>


<html lang="en">
  {% include 'navbar.html' %}
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% block meta %}
    <title>TraveLoGue</title>
    {% endblock meta %}
  
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  
    <!-- Style -->
    <link href="{% static 'styles.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">
  </head>


  <body>
    {% block content %}
    
    

  <div class="container">
    <br>
    <h1 class="text-center">LOCAL SHOPS</h1>
    <br>
    <div class ="row" id="cards">
     
 
      <!-- {% for data in datalist %}
      <div class ="col-12 col-md-6 col-lg-4 " id="list-umkm">
        <div class ="card">
          <div class="card-header overflow-hidden p-0">
            {% if data.image %}
          
            <img class="w-100" src="{{data.image.url}}" >
            {% endif %}
          </div>
          
          <div class="card-body">
            
            <h5 class="card-title">{{data.name}}</h5>
            <h5 class="card-title">{{data.description}}</h5>

            <div>
              <button class ="btn btn-outline-danger tn-light text-decoration-none text-white"><a href="{% url 'umkm:delete_card' data.pk %}" title="">Delete</a></button>
              <button class="btn btn-primary"><a href="{% url 'umkm:add_umkm' %} ">Add</a></button>
            </div>
            
            
          </div>
        </div>
      </div>
      <br>
      
    {% endfor %} -->
    </div>
  </div>

  <button
          class="inline-flex space-x-2 items-center justify-center px-6 py-3 rounded-xl"  data-toggle="modal"
          data-target="#exampleModal"
          
          >
          a
          <!-- <a href="{% url 'umkm:add_umkm' %}  ">Add</a> -->
  </button>

  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered relative w-auto pointer-events-none">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5 text-zinc-200" id="exampleModalLabel">
            Add Task
          </h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="flex justify-center">
            <div class="lg:w-64 mt-3">
              <form method="POST" action="" class="register-form" enctype="multipart/form-data" id='umkmForm'>
                {% csrf_token %}
                <table>
                    <tr>
                        <td>Name: </td>
                        <td>{{form.name}}</td>
                    </tr>
        
                    <tr>
                      <td>Description: </td>
                      <td>{{form.description}}</td>
                    </tr>
        
                  
                    <tr>
                      <td>Image: </td>
                      <td>{{form.image}}</td>
                    </tr>
        
                    <tr>
                      <td>Website: </td>
                      <td>{{form.link_website}}</td>
                    </tr>
                            
                </table>
                <br>
                <input type="submit" name="submit" value="Add Shop" class="submit" id="#add-task" />
                <br>
                <br>
               
            </form>
              </div>
            </div>
          </div>
         
        </div>
      </div>
    </div>

  {% endblock content %}
  
  </body>
  {% include 'footer.html' %}
  
</html>

<script>
  $(document).ready(function () {
      taskCards();

      $('#add-task').click(function () {
                $.post(
                    '/umkm/add_umkm/',
                    {
                        name: $('#name').val(),
                        description: $('#description').val(),
                        link_website: $('#link_website').val(),
                        image : $('#link_website').val(),

                    },
                    function (data, status) {
                        if (status == 'success') {
                            $(`#cards`).append(card(data))
                            $('#name').val('')
                            $('#description').val('')
                            $('#link_website').val('')
                            $('#image').val('')
                        }
                    },
                )
            })
  });
  document.getElementById("button").onclick = addUMKM

  function addUMKM() {
        fetch("/umkm/add_umkm_ajax/", {
        method: "POST",
        body: new FormData(document.querySelector("#umkmForm"))
        }).then(taskCards)
        return false
    }

  function taskCards() {
      let stringHTML = "";
      $.ajax({
          url: "json",
          type: "GET",
          dataType: "json",
          success: function(data) {
              for (i=0; i<data.length; i++){
                  
                  stringHTML += ` 
                  <div class ="col-12 col-md-6 col-lg-4">
                      <div class="card shadow p-3 mb-5 bg-white rounded border-0" style="padding-right: 10px;">
                         
                          <div class="card-body">
                              <h5 class="card-title">${data[i].fields.name}</h5>
                              <br>
                              <p class="card-under-title">${data[i].fields.description}</p>
                              <br>
                              <a href="umkm-detail/${data[i].pk}", class="btn btn-primary">Read More</a>
                              <a href="delete/${data[i].pk}", class="btn btn-danger">Delete</a>
                          </div>
                      </div>
                  </div>`;
                  $('#cards').html(stringHTML);
              }
          }
      });
    }
</script>


{% extends 'base.html' %}
{% load static %}

<html>
  <head>  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% block meta %}
    <title>TraveLoGue</title>
    {% endblock meta %}
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  
    <!-- Style -->
    <link href="{% static 'styles.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">

    {% block script %}
    <script>
      $(document).ready(function () {
        show_attr();
      
      let files
          $('#id_image').on('change', function (event) {
              files = event.target.files
              console.log(files)
          })
      
      
      $("#btn_new_attr").click(function(){
        const formData = new FormData()
              formData.append('image', files[0])
              formData.append('title', $("#id_title").val())
              formData.append('location', $("#id_location").val())
              formData.append('description', $("#id_description").val())
              formData.append('address_link', $("#id_address_link").val())

              $.ajax({
                  url: '/objekwisata/add_objekwisata_ajax/', // point to server-side URL
                  dataType: 'json', // what to expect back from server
                  cache: false,
                  contentType: false,
                  processData: false,
                  data: formData,
                  type: 'post',
                  success: function(result){
                      // console.log(result)
                      $("#card_attr").append(`

                      <div class ="col-12 col-md-6 col-lg-4">
                        <div class="card shadow p-3 mb-5 bg-white rounded border-0" style="padding-right: 10px;">
                        <img class="w-100" src="${result.fields.image.url}" >
                          <div class="card-body">
                            <h2 class="card-title">${result.fields.title}</h2>
                            <h5 class="card-text">${result.fields.location}</h5>
                            <br>
                            <p class="card-text">${result.fields.description}</p>        
                            <a class="card-text stretched-link" href="${result.fields.address_link}" target="_blank">See on maps</a>
                          </div>
                        </div>
                      </div>`);
                      $("#image").val(''),
                      $("#title").val(''),
                      $("#location").val(''),
                      $("#description").val(''),
                      $("#address_link").val('')
                      // alert("Successfully added!")
                  },
                  error: function (response) {
                      $('#msg').html(response.message); // display error response
                  }
              });
          });
        });

        function show_attr() {
          $.get("/objekwisata/json", function(data) {
              console.log(data.length)
              console.log(data)
              for (i=0; i<data.length; i++){
                  $("#card_attr").append(`
                  <div class ="col-12 col-md-6 col-lg-4">
                    <div class="card shadow p-3 mb-5 bg-white rounded border-0" style="padding-right: 10px;">
                    <img class="w-100" src="${data[i].fields.imageURL}" >
                      <div class="card-body">
                        <h2 class="card-title">${data[i].fields.title}</h2>
                        <h5 class="card-text">${data[i].fields.location}</h5>
                        <br>
                        <p class="card-text">${data[i].fields.description}</p>        
                        <a class="card-text stretched-link" href="${data[i].fields.address_link}" target="_blank">See on maps</a>
                      </div>
                    </div>
                  </div>`)
              }
        });

        }
    </script>
    {% endblock script %}
  </head>
  
  {% block content %}
  <body>
    <div class="breadcrumbs d-flex align-items-center" style="background-image: url(/static/images/labuanbajo.jpg);">
      <div class="container position-relative d-flex flex-column align-items-center aos-init aos-animate" data-aos="fade">
          <h2>Recommended Attractions</h2>

          <ol><li>Get below the surface of Indonesia like a local and start a one-of-a-kind adventure.</li></ol>
          <ol><li><a href="index.html">Home</a></li><li>Attractions</li></ol>

      </div>
    </div>
          
    <div class="container">
      <br>
      <div id="blog" class="blog">
        <div class="d-flex justify-content-between align-items-center" style="padding-bottom: 30px;">
            <div>
                <h1>All Attractions</h1>
            </div>
            <div>
              <button type="button" class="btn btn-default my-auto" data-toggle="modal" data-target="#exampleModal">
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                <span style="font-size:1.5rem">&nbsp;Add Attraction</span>
              </button>   
            </div>
        </div>
        <div class ="row">
          <div class ="col-12 col-md-6 col-lg-4" id="card-${data[i].pk}">
            <div class="card shadow p-3 mb-5 bg-white rounded border-0" style="padding-right: 10px;">
            <img class="w-100" src="{% static 'images/borobudur.jpg'  %}" >
              <div class="card-body">
                <h2 class="card-title">Candi Borobudur</h2>
                <h5 class="card-text">Yogyakarta</h5>
                <br>
                <p class="card-text">Lorem ipsum dolor, sit amet consectetur adipisicing elit. Consequatur cupiditate aut dolorum pariatur porro, obcaecati blanditiis maiores! Aperiam suscipit placeat ea ducimus minima repellat rerum laudantium, enim ratione architecto! Et!</p>        
                <a class="card-text stretched-link" href="https://goo.gl/maps/k9BWqqj7uNeZHjqQ9" target="_blank">See on maps</a>                                  
              </div>
            </div>
          </div>
  
          <div class ="col-12 col-md-6 col-lg-4" id="card-${data[i].pk}">
            <div class="card shadow p-3 mb-5 bg-white rounded border-0" style="padding-right: 10px;">
            <img class="w-100" src="{% static 'images/labuanbajo.jpg'  %}" >
              <div class="card-body">
                <h2 class="card-title">Labuan Bajo</h2>
                <h5 class="card-text">Nusa Tenggara Timur</h5>
                <br>
                <p class="card-text">Labuan Bajo is one of small town in Indonesia, so calm and beautiful. The town is the gateway into the charm of Flores to complete travel from the west. However, if only want to enjoy the Varanus Komodoensis, which has been determined to be one of the World's Seven Wonders of Nature, in its natural habitat. Labuan Bajo is an important starting point and the only one of the most convenient and comfortable.</p>        
                <a class="card-text stretched-link" href="https://goo.gl/maps/DFUcQuduLMy5oKte6" target="_blank">See on maps</a>
              </div>
            </div>
          </div>
          
          <div class ="col-12 col-md-6 col-lg-4" id="card-${data[i].pk}">
            <div class="card shadow p-3 mb-5 bg-white rounded border-0" style="padding-right: 10px;">
              <img class="w-100" src="{% static 'images/kawah_ijen.jpg'  %}" >
              <div class="card-body">
                <h2 class="card-title">Ijen Crater / Kawah Ijen</h2>
                <h5 class="card-text">Jawa Timur</h5>
                <br>
                <p class="card-text">Ijen Crater in East Java contains the worldâ€™s largest acidic volcanic crater lake, called Kawah Ijen, famous for its turquoise colour. The volcano is one of several active stratovolcanoes constructed over the 20 km wide Ijen caldera, the largest caldera in Java. Eruptions from Ijen are very hazardous because of the risk of the lake draining to form catastrophic lahars.</p>        
                <a class="card-text stretched-link" href="https://goo.gl/maps/fSHSM5JhJ3iv1kfF6" target="_blank">See on maps</a>
              </div>
            </div>
          </div>
          
          <div class ="col-12 col-md-6 col-lg-4" id="card-${data[i].pk}">
            <div class="card shadow p-3 mb-5 bg-white rounded border-0" style="padding-right: 10px;">
            <img class="w-100" src="{% static 'images/labuanbajo.jpg'  %}" >
              <div class="card-body">
                <h2 class="card-title">Labuan Bajo</h2>
                <h5 class="card-text">Nusa Tenggara Timur</h5>
                <br>
                <p class="card-text">Labuan Bajo is one of small town in Indonesia, so calm and beautiful. The town is the gateway into the charm of Flores to complete travel from the west. However, if only want to enjoy the Varanus Komodoensis, which has been determined to be one of the World's Seven Wonders of Nature, in its natural habitat. Labuan Bajo is an important starting point and the only one of the most convenient and comfortable.</p>        
                <a class="card-text stretched-link" href="https://goo.gl/maps/DFUcQuduLMy5oKte6" target="_blank">See on maps</a>
              </div>
            </div>
          </div>
  
          <div class ="col-12 col-md-6 col-lg-4" id="card-${data[i].pk}">
            <div class="card shadow p-3 mb-5 bg-white rounded border-0" style="padding-right: 10px;">
            <img class="w-100" src="{% static 'images/borobudur.jpg'  %}" >
              <div class="card-body">
                <h2 class="card-title">Candi Borobudur</h2>
                <h5 class="card-text">Yogyakarta</h5>
                <br>
                <p class="card-text">Lorem ipsum dolor, sit amet consectetur adipisicing elit. Consequatur cupiditate aut dolorum pariatur porro, obcaecati blanditiis maiores! Aperiam suscipit placeat ea ducimus minima repellat rerum laudantium, enim ratione architecto! Et!</p>        
                <a class="card-text stretched-link" href="https://goo.gl/maps/k9BWqqj7uNeZHjqQ9" target="_blank">See on maps</a>
              </div>
            </div>
          </div>
          
          <!-- insert new attraction -->
          <div id="card_attr">
          </div>
          
        
        </div>
      </div>
    </div>
    

    <!-- Button trigger modal -->
    <!-- <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
      Add Attraction
    </button> -->

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Add Attraction</h5>
            <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="flex justify-center">
              <div class="lg:w-64 mt-3">
                  <form method="POST" action="" class="register-form" enctype="multipart/form-data" id="objekwisataForm">
                    {% csrf_token %}
                    <table>
                      <tr> 
                        <td>Attraction Name: </td>
                        <td>{{form.title}}</td>
                      </tr>
                      <tr> 
                        <td>Location: </td>
                        <td>{{form.location}}</td>
                      </tr>
                      <tr> 
                        <td>Short Description: </td>
                        <td>{{form.description}}</td>
                      </tr>
                      <tr> 
                        <td>URL Google Maps: </td>
                        <td>{{form.address_link}}</td>
                      </tr>
                      <tr> 
                        <td>Image: </td>
                        <td>{{form.image}}</td>
                      </tr>
                    </table>
                    <br>
                  </form>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary" id="btn_new_attr" data-dismiss="modal">Submit</button>
          </div>
        </div>
      </div>
    </div>
    
  </body>

</html>
{% endblock content %}
